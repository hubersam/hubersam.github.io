<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Samuel Huber">
<meta name="dcterms.date" content="2023-12-03">
<meta name="description" content="Things are about to get Bayesian…">

<title>Blog - Probability Theory and Random Variables</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar floating nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Blog</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/hubersam/hubersam.github.io/" rel="" target=""><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Probability Theory and Random Variables</li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Probability Theory and Random Variables</h1>
                  <div>
        <div class="description">
          Things are about to get Bayesian…
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Samuel Huber </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">December 3, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<p>If you’re reading this, you have just begun your pocket-sized journey into machine learning topics. As with any field, you must start at the basics, and that is where you are now. Unfortunately, in this case, the basics aren’t so basic.</p>
<p>For most people (myself included), probability is one of the hardest concepts to grasp out of all of the mathematical disciplines. Most of the ideas are algebraically and computationally simple, but can be a conceptual nightmare. My only goal for this post is to form a <em>basic</em> layer of understanding with which you can use as a foundation for all of your future endeavours in machine learning.</p>
<p>We will start with basic probability.</p>
<hr>
<section id="basic-probability" class="level1">
<h1>Basic Probability</h1>
<p>We’ll start with some terminology.</p>
<ul>
<li>The set of all possible outcomes is called the <strong><em>sample space</em></strong>, and is usually given the symbol <span class="math inline">\(S\)</span>.</li>
<li>The probability of a <strong><em>event</em></strong>, <span class="math inline">\(A\)</span>, occurring can be calculated by taking the ratio of the cardinalities of the event and the sample space, <span class="math inline">\(P(A) = \frac{\left| A \right|}{\left| S \right|}\)</span>.</li>
</ul>
<p>There were a lot of big words in there, so let’s take a look at an example. Imagine rolling a fair six-sided die. There are six equally likely possible outcomes: 1, 2, 3, 4, 5, 6. Therefore, since there are no other possible outcomes, then we have our sample space:</p>
<p><span class="math display">\[S = \{ 1, 2, 3, 4, 5, 6 \}\]</span></p>
<p>Now, let’s describe an “event”. We will call <span class="math inline">\(A\)</span> the event where we roll an even number. Then we can write:</p>
<p><span class="math display">\[A = \{ 2, 4, 6 \}\]</span></p>
<p>Now look at the third rule again. The symbols and big words may look complicated, but “taking the ratio of the cardinalities of the event and the sample space” really just means counting up the number of elements in our event and dividing it by the total number of possible elements. In our case, there are three possible even numbers, and six possible total numbers, so:</p>
<p><span class="math display">\[P(A) = \frac{\left| A \right|}{\left| S \right|} = \frac{3}{6} = \frac{1}{2} = 0.5 = 50\%\]</span></p>
<p>This should be making sense so far. There are a few other things we can deduce from this simple equation too. Let’s calculate the probability of the sample space:</p>
<p><span class="math display">\[P(S) = \frac{\left| S \right|}{\left| S \right|} = \frac{6}{6} = 1 = 100\%\]</span></p>
<p>This should also make sense. The probability of <em>any</em> of the possible values occurring should be guaranteed. What about a set with nothing in it? We’ll call that set <span class="math inline">\(B\)</span>:</p>
<p><span class="math display">\[B = \{\}\]</span></p>
<p>Then the probability of <span class="math inline">\(B\)</span> occuring is:</p>
<p><span class="math display">\[P(B) = \frac{\left| B \right|}{\left| S \right|} = \frac{0}{6} = 0\]</span></p>
<p>Which also makes sense. This gives us insight into the range of values that a probability should be able to take:</p>
<p><span class="math display">\[0 \leq P(A) \leq 1\]</span></p>
<p>This goes for all scenarios; not just for the die example.</p>
<hr>
</section>
<section id="probability-of-this-and-that" class="level1">
<h1>Probability of This and That</h1>
<p>Let’s extend our example by imagining that we roll two dice, one by one. The first roll can take on any one of six values, and the second one can take on six different values for each of the six values that the first roll could have taken. This gives us <span class="math inline">\(6 \times 6 = 36\)</span> different possible outcomes. Let’s write our sample space like this:</p>
<p><span class="math display">\[S = \{ (1, 1), (1, 2), (1, 3) \ldots (6, 5), (6, 6) \}\]</span></p>
<p>What is the probability of the first roll being a <span class="math inline">\(2\)</span>? Let’s write the set for the event of all combinations of rolls where the first roll is a <span class="math inline">\(2\)</span>:</p>
<p><span class="math display">\[A = \{ (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6) \}\]</span></p>
<p>And finally:</p>
<p><span class="math display">\[P(A) = \frac{\left| A \right|}{\left| S \right|} = \frac{6}{36} = \frac{1}{6} \approx 16.67\%\]</span></p>
<p>Let’s try another probability. This time we ask ourselves, “what’s the probability that our second roll is <span class="math inline">\(5\)</span>”? Well, this set is very similar to the previous one:</p>
<p><span class="math display">\[B = \{ (1, 5), (2, 5), (3, 5), (4, 5), (5, 5), (6, 5) \}\]</span></p>
<p>And the probability is identical:</p>
<p><span class="math display">\[P(B) = \frac{\left| B \right|}{\left| S \right|} = \frac{6}{36} = \frac{1}{6} \approx 16.67\%\]</span></p>
<p>Last example! What’s the probability that the first roll is <span class="math inline">\(2\)</span>, <strong><em>and</em></strong> that our second roll is <span class="math inline">\(5\)</span>? Well, this set is pretty simple:</p>
<p><span class="math display">\[C = \{ (2, 5) \}\]</span></p>
<p>So our probability is:</p>
<p><span class="math display">\[P(C) = \frac{\left| B \right|}{\left| S \right|} = \frac{1}{36} \approx 2.78\%\]</span></p>
<p>This is correct, but we have a more powerful technique up our sleeve. In order to find it, let’s look at a visual representation of our example:</p>
<div class="cell" data-tags="[]" data-execution_count="2">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-2-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The red circle on the left represents all outcomes in the <span class="math inline">\(A\)</span> event, and the green circle on the right represents all outcomes in the <span class="math inline">\(B\)</span> event. Notice that the intersection of these two regions shows the outcome for event <span class="math inline">\(C\)</span>.</p>
<p>There are two main operations when it comes to sets that are very useful for determining more advanced probabilities.</p>
<ul>
<li>Union</li>
<li>Intersection</li>
</ul>
<p>The <strong><em>union</em></strong>, given the symbol <span class="math inline">\(\cup\)</span>, is defined as the set of all events that both <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> contain. In the case of our picture, this is what the union looks like:</p>
<div class="cell" data-tags="[]" data-execution_count="79">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-3-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Conversely, the <strong><em>intersection</em></strong>, given the symbol <span class="math inline">\(\cap\)</span>, gives the set of outcomes that <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> <em>share</em>. Here is the diagram:</p>
<div class="cell" data-tags="[]" data-execution_count="83">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-4-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>You can think of it this way:</p>
<ul>
<li><span class="math inline">\(A \cup B = A~\mathrm{or}~B\)</span></li>
<li><span class="math inline">\(A \cap B = A~\mathrm{and}~B\)</span></li>
</ul>
<p>But why is this useful? Well, there’s a really cool relationship that we can derive between the two of them just using the information so far. Here’s how we do it.</p>
<p>Imagine taking the individual probabilities of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> and adding them together. In doing this, you’d have calculated the probability of the union of the two events, plus a little extra. This little extra comes from the fact that both sets contain their intersection, so you counted the intersection twice on accident. The first copy contributed to the union of the two sets, the second copy is the “little extra”. In other words:</p>
<p><span class="math display">\[P(A) + P(B) = P(A \cup B) + P(A \cap B)\]</span></p>
<p>We can rearrange this equation to get our desired result:</p>
<p><span class="math display">\[P(A \cap B) = P(A) + P(B) - P(A \cup B)\]</span></p>
<p>Let’s use this equation to recalculate the probability of <span class="math inline">\(C\)</span> again. That is, let’s calculate the probability that the first roll is <span class="math inline">\(2\)</span> and that the second roll is <span class="math inline">\(5\)</span>.</p>
<p>First, we need to find <span class="math inline">\(A \cup B\)</span>. Remember, this is the same as asking for all outcomes where the first number is <span class="math inline">\(2\)</span> <strong><em>or</em></strong> that the second number is <span class="math inline">\(5\)</span>. We can take all of the individual elements from <span class="math inline">\(A\)</span> and be <span class="math inline">\(B\)</span> independently (making sure not to double count any) and place them together:</p>
<p><span class="math display">\[A \cup B = \{ (2, 1), (2, 2), (2, 3), (2, 4), (2, 5), (2, 6), (1, 5), (3, 5), (4, 5), (5, 5), (6, 5) \}\]</span></p>
<p><em>Notice that <span class="math inline">\((2, 5)\)</span> appears in both sets, but we only count it once.</em></p>
<p>Let’s get this probability:</p>
<p><span class="math display">\[P(A \cup B) = \frac{\left| A \cup B \right|}{\left| S \right|} = \frac{11}{36} \approx 30.56\%\]</span></p>
<p>Now we can get to calculating!</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
P(C) = P(A \cap B) &amp;= P(A) + P(B) - P(A \cup B)\\
&amp;= \frac{1}{6} + \frac{1}{6} - \frac{11}{36}\\
&amp;= \frac{1}{36} \approx 2.78\%
\end{split}
\end{equation}\]</span></p>
<p>Exactly the same as last time!</p>
<p>This process may seem far more cumbersome than the original calculation, but as the sets of events start increasing in size, it is <strong>much</strong> easier to know how to calculate probabilities of intersections of events from other probabilities as opposed to actually counting it out.</p>
<hr>
</section>
<section id="conditional-probability" class="level1">
<h1>Conditional Probability</h1>
<p>Let’s extend our example by imagining that we roll the same die five times. The die is still fair, and takes on one of six values every roll. We will then track the total sum of all the rolls. For example, if the values that appeared during the rolls were <span class="math inline">\(1, 4, 3, 6, 2\)</span>, the total would be <span class="math inline">\(1 + 4 + 3 + 6 + 2 = 16\)</span>.</p>
<p>Before we get started, let’s analyze what we know right away. We know that the total number of possible rolls is <span class="math inline">\(6^5 = 7,776\)</span>. We also know that the lowest sum possible is <span class="math inline">\(1 + 1 + 1 + 1 + 1 = 5\)</span>, and the highest is <span class="math inline">\(6 + 6 + 6 + 6 + 6 = 30\)</span>. These both occur only once, since they only have one set of numbers that can provide that sum. Conversely, other sums will occur far more often. For example, imagine a sum where all the rolls are different numbers: <span class="math inline">\(1 + 2 + 3 + 4 + 5 = 15\)</span>. Since these rolls could have happened in any order, and there are <span class="math inline">\(5! = 5 \times 4 \times 3 \times 2 \times 1 = 120\)</span> different possible orderings, then the chances of getting a sum of <span class="math inline">\(15\)</span> is much higher than getting a sum of <span class="math inline">\(5\)</span> or <span class="math inline">\(30\)</span>.</p>
<p>This gives us insight that the distribution of outcomes is going to be most common near the average roll value (<span class="math inline">\(\frac{30 + 5}{2} = 17.5\)</span>), since there are far more ways of arranging the sums, than at the low or high extremes. Let’s look at the graph of the rolls:</p>
<div class="cell" data-tags="[]" data-execution_count="32">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>allRolls <span class="op">=</span> []</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>currRoll <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> a <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">7</span>):</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    currRoll[<span class="dv">0</span>] <span class="op">=</span> a</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> b <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">7</span>):</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>        currRoll[<span class="dv">1</span>] <span class="op">=</span> b</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> c <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">7</span>):</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>            currRoll[<span class="dv">2</span>] <span class="op">=</span> c</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> d <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">7</span>):</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>                currRoll[<span class="dv">3</span>] <span class="op">=</span> d</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> e <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="dv">7</span>):</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                    currRoll[<span class="dv">4</span>] <span class="op">=</span> e</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>                    allRolls.append(currRoll.copy())</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>                    </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>allRollSums <span class="op">=</span> [<span class="bu">sum</span>(roll) <span class="cf">for</span> roll <span class="kw">in</span> allRolls]</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>sumValues <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">5</span>, <span class="dv">30</span> <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>sumCounts <span class="op">=</span> [allRollSums.count(value) <span class="cf">for</span> value <span class="kw">in</span> sumValues]</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.ticker <span class="im">as</span> mtick</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(sumCounts, sumValues)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>df.plot.bar(rot<span class="op">=</span><span class="dv">0</span>, width<span class="op">=</span><span class="fl">0.85</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Sum of Rolls"</span>)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Number of Occurrences"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>Text(0, 0.5, 'Number of Occurrences')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-5-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Just as we predicted. This graph is a great example of a <strong><em>Gaussian Distribution</em></strong>. Let’s divide each of the individual “number of occurrences” values by the total number of possible rolls (<span class="math inline">\(7,776\)</span>) to get the probability of getting each sum:</p>
<div class="cell" data-tags="[]" data-execution_count="35">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>normalizedSumCounts <span class="op">=</span> [count <span class="op">/</span> <span class="bu">sum</span>(sumCounts) <span class="cf">for</span> count <span class="kw">in</span> sumCounts]</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(normalizedSumCounts, sumValues)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> df.plot.bar(rot<span class="op">=</span><span class="dv">0</span>, width<span class="op">=</span><span class="fl">0.85</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Sum of Rolls"</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Chance of Occurrence"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>ax.yaxis.set_major_formatter(mtick.PercentFormatter(<span class="fl">1.0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-6-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Very nice. We can see that getting a sum of around <span class="math inline">\(17\)</span> or <span class="math inline">\(18\)</span> will happen in about <span class="math inline">\(1\)</span> in every <span class="math inline">\(10\)</span> rolls, while getting a sum of <span class="math inline">\(5\)</span> or <span class="math inline">\(30\)</span> is not probable at all (<span class="math inline">\(\frac{1}{7776} \approx 0.0129\%\)</span>).</p>
<p>We can also find the probability of obtaining a <em>range</em> of values very easily. All we have to do is add the probability of obtaining each sum within the range. For example, the probability of getting a sum between <span class="math inline">\(16\)</span> and <span class="math inline">\(19\)</span> (inclusive) would be:</p>
<p><span class="math display">\[\begin{equation}
\begin{split}
P\left(16 \leq \sum_{i=1}^{5}x_i \leq 19\right) &amp;= P(16 \leq x_1 + x_2 + x_3 + x_4 + x_5 \leq 19)\\
&amp;= P(16) + P(17) + P(18) + P(19)
\end{split}
\end{equation}\]</span></p>
<div class="cell" data-tags="[]" data-execution_count="74">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sumRange <span class="op">=</span> <span class="bu">range</span>(<span class="dv">16</span>, <span class="dv">19</span> <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>sumRangeProbs <span class="op">=</span> [normalizedSumCounts[sumValues.index(value)] <span class="cf">for</span> value <span class="kw">in</span> sumValues <span class="cf">if</span> value <span class="kw">in</span> sumRange]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="sc">{}</span><span class="st">%"</span>.<span class="bu">format</span>(<span class="bu">round</span>(<span class="bu">sum</span>(sumRangeProbs <span class="op">*</span> <span class="dv">100</span>), <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>38.97%</code></pre>
</div>
</div>
<p>Neat! This shows that more than a third of all of the sums of five rolls will be somewhere between <span class="math inline">\(16\)</span> and <span class="math inline">\(19\)</span>.</p>
<p>This has led us to one of the most important parts of probability. Let’s ask a much more interesting and insightful question: what is the probability that the sum will be between <span class="math inline">\(16\)</span> and <span class="math inline">\(19\)</span> <strong><em>given that the first three rolls add up to</em></strong> <span class="math inline">\(14\)</span>? At first glance, this question may seem to have the same answer as the previous question. After all, why should the knowledge of our first three rolls affect the outcome? Well, as it turns out, this new information essentially excludes sequences of rolls that we would have otherwise considered. To understand how to solve this, let’s look at a graphical representation again:</p>
<div class="cell" data-tags="[]" data-execution_count="76">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-8-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The probability for of an event occurring <strong><em>given another event</em></strong> is written as <span class="math inline">\(P(\mathrm{Event~1} | \mathrm{Event~2})\)</span>. For example, the probability of <span class="math inline">\(A\)</span> given <span class="math inline">\(B\)</span> is <span class="math inline">\(P(A|B)\)</span>.</p>
<p>Determining a relationship for this is not hard. We are essentially asking, “what is the probability of <span class="math inline">\(A\)</span> being true, given that <span class="math inline">\(B\)</span> is also true?” We know that a typical probability is the ratio of the number of occurrences of that event to the number of possible occurrences: <span class="math inline">\(P(A) = \frac{\left| A \right|}{\left| S \right|}\)</span>. However, in this case, the event we’re concerned with is the <em>intersection</em> of two events (since both <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are true), so the numerator should be the number of occurrences of the intersection, <span class="math inline">\(\left| A \cap B \right|\)</span>. The other difference is, <strong><em>the number of possible occurrences is no longer the sample space</em></strong>. Instead, it is the <strong><em>number of occurrences of the second event</em></strong>, <span class="math inline">\(\left| B \right|\)</span>. Let’s visualize this:</p>
<div class="cell" data-tags="[]" data-execution_count="81">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-9-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Here is a visual representation of the events where <span class="math inline">\(B\)</span> is true, but <span class="math inline">\(A\)</span> is <em>not</em> true. This can be written as <span class="math inline">\(B \cap \neg A\)</span>, where the <span class="math inline">\(\neg\)</span> symbol means “not”. Now, let’s reinclude the intersection of <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>:</p>
<div class="cell" data-tags="[]" data-execution_count="90">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-10-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Now we have visually represented the question, “what is the chance that <span class="math inline">\(A\)</span> is true, given that <span class="math inline">\(B\)</span> is also true?” We know that this probability should be the number of cases where both <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> are true, divided by all of the cases where <span class="math inline">\(B\)</span> is true. Another way of thinking about this is that <span class="math inline">\(B\)</span> has essentially become a “new sample space”, and <span class="math inline">\(P(A \cap B)\)</span> is what we’re trying to calculate. Visually:</p>
<div class="cell" data-tags="[]" data-execution_count="121">
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-11-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>So our equation is:</p>
<p><span class="math display">\[P(A|B) = \frac{\left| A \cap B \right|}{\left|B \right|}\]</span></p>
<p>Let’s do some algebraic magic:</p>
<p><span class="math display">\[P(A|B) = \frac{\left| A \cap B \right|}{\left|B \right|} \times \frac{\frac{1}{\left| S \right|}}{\frac{1}{\left| S \right|}} = \frac{\frac{\left| A \cap B \right|}{\left| S \right|}}{\frac{\left| B \right|}{\left| S \right|}} = \frac{P(A \cap B)}{P(B)}\]</span></p>
<p>So now we can firmly state that the problem of <span class="math inline">\(A\)</span> given <span class="math inline">\(B\)</span> is equal to the probability of <span class="math inline">\(A\)</span> <em>and</em> <span class="math inline">\(B\)</span>, divided by the probability of <span class="math inline">\(B\)</span>:</p>
<p><span class="math display">\[P(A|B) = \frac{P(A \cap B)}{P(B)}\]</span></p>
<p>Let’s apply this to the original question: “what is the probability that the sum will be between <span class="math inline">\(16\)</span> and <span class="math inline">\(19\)</span> given that the first three rolls add up to <span class="math inline">\(14\)</span>?”:</p>
<p><span class="math display">\[P\left(16 \leq \left.\sum_{i=1}^{5}x_i \leq 19 \right| \sum_{i=1}^{3}x_i = 14\right) = \frac{P\left(16 \leq \sum\limits_{i=1}^{5}x_i \leq 19~\mathrm{and}~\sum\limits_{i=1}^{3}x_i = 14\right)}{P\left(\sum\limits_{i=1}^{3}x_i = 14\right)}\]</span></p>
<div class="cell" data-tags="[]" data-execution_count="138">
<div class="cell-output cell-output-stdout">
<pre><code>27.78%</code></pre>
</div>
</div>
<p>So, as it turns out, if your first three rolls sum to a <span class="math inline">\(14\)</span>, you have slightly more than a one in four chance to have a total sum between <span class="math inline">\(16\)</span> and <span class="math inline">\(19\)</span>. Just for fun, let’s plot the conditional probability of rolling between <span class="math inline">\(16\)</span> and <span class="math inline">\(19\)</span> given different sums for the first three rolls:</p>
<div class="cell" data-tags="[]" data-execution_count="135">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>firstThreeSum <span class="op">=</span> <span class="bu">range</span>(<span class="dv">3</span>, <span class="dv">18</span> <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>chances <span class="op">=</span> []</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> firstThreeSum:</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    firstThreeRollSums <span class="op">=</span> [<span class="bu">sum</span>(roll) <span class="cf">for</span> roll <span class="kw">in</span> allRolls <span class="cf">if</span> roll[<span class="dv">0</span>] <span class="op">+</span> roll[<span class="dv">1</span>] <span class="op">+</span> roll[<span class="dv">2</span>] <span class="op">==</span> i]</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    firstThreeRollSumsInRange <span class="op">=</span> [roll <span class="cf">for</span> roll <span class="kw">in</span> firstThreeRollSums <span class="cf">if</span> roll <span class="op">&gt;=</span> <span class="dv">16</span> <span class="kw">and</span> roll <span class="op">&lt;=</span> <span class="dv">19</span>]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    chances.append(<span class="bu">len</span>(firstThreeRollSumsInRange) <span class="op">/</span> <span class="bu">len</span>(firstThreeRollSums))</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(chances, firstThreeSum)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> df.plot.bar(rot<span class="op">=</span><span class="dv">0</span>, width<span class="op">=</span><span class="fl">0.85</span>, legend<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">"Sum of First Three Rolls"</span>)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">"Chance of Total Sum Between 16 and 19"</span>)</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>ax.yaxis.set_major_formatter(mtick.PercentFormatter(<span class="fl">1.0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-13-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can see that if the first three rolls sum to <span class="math inline">\(3\)</span>, even the highest values for the other rolls can’t reach the range: <span class="math inline">\(1 + 1 + 1 + 6 + 6 = 15 &lt; 16\)</span>. This applies to <span class="math inline">\(18\)</span> as well: <span class="math inline">\(6 + 6 + 6 + 1 + 1 = 20 &gt; 19\)</span>. As it turns out, the sums of the first three values that gives you the highest chances of rolling within the range are <span class="math inline">\(10\)</span> and <span class="math inline">\(11\)</span>.</p>
<p>Funnily enough, if your first three rolls sum to <span class="math inline">\(9\)</span> or <span class="math inline">\(12\)</span>, your chances of landing in the range are <strong>exactly</strong> <span class="math inline">\(50\%\)</span>. Another quirk is that if your first three rolls sum to <span class="math inline">\(8\)</span> or <span class="math inline">\(13\)</span>, your chances of landing in the range is <span class="math inline">\(38.89\%\)</span>, which is almost identical to the original chance of rolling within the range, <span class="math inline">\(P(A)\)</span>!</p>
<hr>
</section>
<section id="bayes-rule" class="level1">
<h1>Bayes’ Rule</h1>
<p>We have now entered the final (and most important) section. All of the previous knowledge has been building up to this point.<br>
</p>
<p>Let’s examine the conditional probability equation again:</p>
<p><span class="math display">\[P(A|B) = \frac{P(A \cap B)}{P(B)}\]</span></p>
<p>We can rearrange it like so:</p>
<p><span class="math display">\[P(A \cap B) = P(A|B)P(B)\]</span></p>
<p>At this point, we can note that <span class="math inline">\(P(A \cap B) = P(B \cap A)\)</span>, since the intersection of the two sets remains the same regardless of order. Let’s examine the conditional probability using this order:</p>
<p><span class="math display">\[P(B \cap A) = P(B|A)P(A)\]</span></p>
<p>Since <span class="math inline">\(P(A \cap B) = P(B \cap A)\)</span>, then the right sides of each of the equations should be equal to each other:</p>
<p><span class="math display">\[P(A|B)P(B) = P(B|A)P(A)\]</span></p>
<p>And we can rearrange once more to give:</p>
<p><span class="math display">\[P(A|B) = \frac{P(B|A)P(A)}{P(B)}\]</span></p>
<p>This is known as <strong><em>Bayes’ Rule</em></strong>, and is one of the most important machine learning concepts. It shows that there is a fundamental relationship between conditional probabilities with different orderings. What’s amazing about this relationship is that no assumptions have been made; this is true for all probabilities.</p>
<p>To demonstrate this, we will use a real dataset. This dataset comes from U.S. census reports from 2011 to 2015, and gives information about household income along with location, state, zip code, etc. It was downloaded from <a href="https://www.kaggle.com/datasets/goldenoakresearch/us-household-income-stats-geo-locations/data">Kaggle</a>. Let’s visualize the first few data points:</p>
<div class="cell" data-tags="[]" data-execution_count="229">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'kaggle_income.csv'</span>, encoding<span class="op">=</span><span class="st">'windows-1252'</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="229">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">id</th>
<th data-quarto-table-cell-role="th">State_Code</th>
<th data-quarto-table-cell-role="th">State_Name</th>
<th data-quarto-table-cell-role="th">State_ab</th>
<th data-quarto-table-cell-role="th">County</th>
<th data-quarto-table-cell-role="th">City</th>
<th data-quarto-table-cell-role="th">Place</th>
<th data-quarto-table-cell-role="th">Type</th>
<th data-quarto-table-cell-role="th">Primary</th>
<th data-quarto-table-cell-role="th">Zip_Code</th>
<th data-quarto-table-cell-role="th">Area_Code</th>
<th data-quarto-table-cell-role="th">ALand</th>
<th data-quarto-table-cell-role="th">AWater</th>
<th data-quarto-table-cell-role="th">Lat</th>
<th data-quarto-table-cell-role="th">Lon</th>
<th data-quarto-table-cell-role="th">Mean</th>
<th data-quarto-table-cell-role="th">Median</th>
<th data-quarto-table-cell-role="th">Stdev</th>
<th data-quarto-table-cell-role="th">sum_w</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1011000</td>
<td>1</td>
<td>Alabama</td>
<td>AL</td>
<td>Mobile County</td>
<td>Chickasaw</td>
<td>Chickasaw city</td>
<td>City</td>
<td>place</td>
<td>36611</td>
<td>251</td>
<td>10894952</td>
<td>909156</td>
<td>30.771450</td>
<td>-88.079697</td>
<td>38773</td>
<td>30506</td>
<td>33101</td>
<td>1638.260513</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">1</td>
<td>1011010</td>
<td>1</td>
<td>Alabama</td>
<td>AL</td>
<td>Barbour County</td>
<td>Louisville</td>
<td>Clio city</td>
<td>City</td>
<td>place</td>
<td>36048</td>
<td>334</td>
<td>26070325</td>
<td>23254</td>
<td>31.708516</td>
<td>-85.611039</td>
<td>37725</td>
<td>19528</td>
<td>43789</td>
<td>258.017685</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">2</td>
<td>1011020</td>
<td>1</td>
<td>Alabama</td>
<td>AL</td>
<td>Shelby County</td>
<td>Columbiana</td>
<td>Columbiana city</td>
<td>City</td>
<td>place</td>
<td>35051</td>
<td>205</td>
<td>44835274</td>
<td>261034</td>
<td>33.191452</td>
<td>-86.615618</td>
<td>54606</td>
<td>31930</td>
<td>57348</td>
<td>926.031000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">3</td>
<td>1011030</td>
<td>1</td>
<td>Alabama</td>
<td>AL</td>
<td>Mobile County</td>
<td>Satsuma</td>
<td>Creola city</td>
<td>City</td>
<td>place</td>
<td>36572</td>
<td>251</td>
<td>36878729</td>
<td>2374530</td>
<td>30.874343</td>
<td>-88.009442</td>
<td>63919</td>
<td>52814</td>
<td>47707</td>
<td>378.114619</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">4</td>
<td>1011040</td>
<td>1</td>
<td>Alabama</td>
<td>AL</td>
<td>Mobile County</td>
<td>Dauphin Island</td>
<td>Dauphin Island</td>
<td>Town</td>
<td>place</td>
<td>36528</td>
<td>251</td>
<td>16204185</td>
<td>413605152</td>
<td>30.250913</td>
<td>-88.171268</td>
<td>77948</td>
<td>67225</td>
<td>54270</td>
<td>282.320328</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>There’s quite a bit of data here to look at. Let’s see if we can plot this somehow:</p>
<div class="cell" data-tags="[]" data-execution_count="231">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>df.plot(kind<span class="op">=</span><span class="st">"scatter"</span>, x<span class="op">=</span><span class="st">"Lon"</span>, y<span class="op">=</span><span class="st">"Lat"</span>, grid<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Longitude'</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Latitude'</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/cell-15-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can clearly see that this dataset has data from Alaska, Hawaii, and even Puerto Rico. We can see all the different parameters and their data types here:</p>
<div class="cell" data-tags="[]" data-execution_count="232">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 32526 entries, 0 to 32525
Data columns (total 19 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   id          32526 non-null  int64  
 1   State_Code  32526 non-null  int64  
 2   State_Name  32526 non-null  object 
 3   State_ab    32526 non-null  object 
 4   County      32526 non-null  object 
 5   City        32526 non-null  object 
 6   Place       32526 non-null  object 
 7   Type        32526 non-null  object 
 8   Primary     32526 non-null  object 
 9   Zip_Code    32526 non-null  int64  
 10  Area_Code   32526 non-null  object 
 11  ALand       32526 non-null  int64  
 12  AWater      32526 non-null  int64  
 13  Lat         32526 non-null  float64
 14  Lon         32526 non-null  float64
 15  Mean        32526 non-null  int64  
 16  Median      32526 non-null  int64  
 17  Stdev       32526 non-null  int64  
 18  sum_w       32526 non-null  float64
dtypes: float64(3), int64(8), object(8)
memory usage: 4.7+ MB</code></pre>
</div>
</div>
<p>For the object types, we can see what different values they can take like this:</p>
<div class="cell" data-tags="[]" data-execution_count="233">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">"State_Name"</span>].value_counts()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="233">
<pre><code>State_Name
California              3280
Texas                   2300
New York                2160
Florida                 1661
Pennsylvania            1475
Illinois                1431
Ohio                    1349
Michigan                1174
North Carolina           915
New Jersey               888
Georgia                  818
Virginia                 785
Indiana                  704
Missouri                 700
Washington               688
Wisconsin                674
Massachusetts            670
Minnesota                641
Arizona                  617
Tennessee                610
Maryland                 586
Alabama                  526
Colorado                 526
Louisiana                511
Kentucky                 497
Oklahoma                 480
South Carolina           459
Iowa                     454
Oregon                   387
Kansas                   381
Puerto Rico              380
Connecticut              355
Arkansas                 340
Mississippi              321
Nebraska                 275
Nevada                   265
Utah                     261
West Virginia            248
New Mexico               240
Maine                    157
Idaho                    149
Montana                  148
Hawaii                   138
New Hampshire            131
South Dakota             128
North Dakota             119
Rhode Island             109
Alaska                   105
Delaware                  88
Vermont                   83
Wyoming                   75
District of Columbia      64
Name: count, dtype: int64</code></pre>
</div>
</div>
<p>California has the highest number of data points (no surprise there), while D.C. has the fewest. Now that we’ve had a look around, let’s focus on Virginia:</p>
<div class="cell" data-tags="[]" data-execution_count="296">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>virginia <span class="op">=</span> df.copy()</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>virginia <span class="op">=</span> virginia.drop([<span class="st">"id"</span>, <span class="st">"State_Code"</span>, <span class="st">"Zip_Code"</span>, <span class="st">"State_ab"</span>, <span class="st">"Area_Code"</span>, <span class="st">"ALand"</span>, <span class="st">"AWater"</span>], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>virginia <span class="op">=</span> virginia[virginia[<span class="st">"State_Name"</span>] <span class="op">==</span> <span class="st">"Virginia"</span>]</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>virginia <span class="op">=</span> virginia[virginia[<span class="st">"Type"</span>] <span class="op">==</span> <span class="st">"Track"</span>]</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>virginia.describe()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="296">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Lat</th>
<th data-quarto-table-cell-role="th">Lon</th>
<th data-quarto-table-cell-role="th">Mean</th>
<th data-quarto-table-cell-role="th">Median</th>
<th data-quarto-table-cell-role="th">Stdev</th>
<th data-quarto-table-cell-role="th">sum_w</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">count</td>
<td>724.000000</td>
<td>724.000000</td>
<td>724.000000</td>
<td>724.000000</td>
<td>724.000000</td>
<td>724.000000</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">mean</td>
<td>37.751752</td>
<td>-77.849723</td>
<td>79952.308011</td>
<td>105208.250000</td>
<td>51075.248619</td>
<td>434.758474</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">std</td>
<td>0.835956</td>
<td>1.512712</td>
<td>39089.677211</td>
<td>95940.593647</td>
<td>16825.048860</td>
<td>358.204421</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">min</td>
<td>36.581972</td>
<td>-83.106093</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">25%</td>
<td>36.983112</td>
<td>-78.518816</td>
<td>52039.500000</td>
<td>41727.250000</td>
<td>39309.500000</td>
<td>201.326579</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">50%</td>
<td>37.519565</td>
<td>-77.420987</td>
<td>70964.500000</td>
<td>63942.000000</td>
<td>51219.500000</td>
<td>327.972570</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">75%</td>
<td>38.736408</td>
<td>-77.057345</td>
<td>101269.000000</td>
<td>119256.250000</td>
<td>64484.250000</td>
<td>511.870572</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">max</td>
<td>39.345172</td>
<td>-75.503313</td>
<td>205835.000000</td>
<td>300000.000000</td>
<td>94395.000000</td>
<td>2328.854201</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>I took the liberty of removing some of the information that I’m not planning on using, such as the state abbreviations, zip codes, and others. I also narrowed the location types to “Track” since it is the most narrow result you can get in this dataset.</p>
<p>We can see some important values, like the maximum and minimum values for housing number and average household income. Let’s plot this to get a better look:</p>
<div class="cell" data-tags="[]" data-execution_count="297">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>virginia.plot(kind<span class="op">=</span><span class="st">"scatter"</span>, x<span class="op">=</span><span class="st">"Lon"</span>, y<span class="op">=</span><span class="st">"Lat"</span>, grid<span class="op">=</span><span class="va">True</span>, s<span class="op">=</span>virginia[<span class="st">"sum_w"</span>] <span class="op">/</span> <span class="dv">15</span>, c<span class="op">=</span><span class="st">"Mean"</span>, cmap<span class="op">=</span><span class="st">"jet"</span>, colorbar<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="fl">4.8</span> <span class="op">*</span> (<span class="dv">8</span> <span class="op">/</span> <span class="dv">3</span>), <span class="fl">4.8</span>))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Longitude'</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Latitude'</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-19-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Looking at this graph, the number of houses is represented by the size of the data point, and the average household income is represented by the color. We can see that the average household income seems to increase the more Northeast that you go. Let’s plot all points that are above the average of the average household incomes, which is around <span class="math inline">\(\$80,000\)</span>:</p>
<div class="cell" data-tags="[]" data-execution_count="313">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>aboveMeans <span class="op">=</span> virginia[virginia[<span class="st">"Mean"</span>] <span class="op">&gt;</span> virginia[<span class="st">"Mean"</span>].mean()]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>aboveMeans.plot(kind<span class="op">=</span><span class="st">"scatter"</span>, x<span class="op">=</span><span class="st">"Lon"</span>, y<span class="op">=</span><span class="st">"Lat"</span>, grid<span class="op">=</span><span class="va">True</span>, s<span class="op">=</span>aboveMeans[<span class="st">"sum_w"</span>] <span class="op">/</span> <span class="dv">15</span>, c<span class="op">=</span><span class="st">"Mean"</span>, cmap<span class="op">=</span><span class="st">"jet"</span>, colorbar<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="fl">4.8</span> <span class="op">*</span> (<span class="dv">8</span> <span class="op">/</span> <span class="dv">3</span>), <span class="fl">4.8</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Longitude'</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Latitude'</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="index_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Unfortunately, this data set does not contain information about the population densities of these locations. However, a quick Google search shows that there are roughly <span class="math inline">\(3\)</span> people per household in Virginia, so let’s estimate the population of Virginia:</p>
<div class="cell" data-tags="[]" data-execution_count="316">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">int</span>(<span class="bu">round</span>(<span class="bu">sum</span>(virginia[<span class="st">"sum_w"</span>] <span class="op">*</span> <span class="dv">3</span>), <span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="316">
<pre><code>944295</code></pre>
</div>
</div>
<p>This is about <span class="math inline">\(\frac{1}{8}\)</span> of the actual population, but the probabilities that we will calculate using this will not be too far from the truth.</p>
<p>Let’s do some calculations now. Let’s find the conditional probability of making more than the average household income given that you are living on the right side of the midline of Virginia:</p>
<p><span class="math display">\[P(A|B) = \frac{P(A \cap B)}{P(B)}\]</span></p>
<div class="cell" data-tags="[]" data-execution_count="318">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>midLong <span class="op">=</span> (virginia[<span class="st">"Lon"</span>].<span class="bu">max</span>() <span class="op">+</span> virginia[<span class="st">"Lon"</span>].<span class="bu">min</span>()) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>midLong</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="318">
<pre><code>-79.304703</code></pre>
</div>
</div>
<div class="cell" data-tags="[]" data-execution_count="329">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>rightSideVirginia <span class="op">=</span> virginia[virginia[<span class="st">"Lon"</span>] <span class="op">&gt;</span> midLong]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>aboveMeanRightSideVirginia <span class="op">=</span> rightSideVirginia[rightSideVirginia[<span class="st">"Mean"</span>] <span class="op">&gt;</span> rightSideVirginia[<span class="st">"Mean"</span>].mean()]</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>probAGivenB <span class="op">=</span> <span class="bu">sum</span>(aboveMeanRightSideVirginia[<span class="st">"sum_w"</span>]) <span class="op">/</span> <span class="bu">sum</span>(rightSideVirginia[<span class="st">"sum_w"</span>])</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="sc">{}</span><span class="st">%"</span>.<span class="bu">format</span>(<span class="bu">round</span>(probAGivenB <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>30.21%</code></pre>
</div>
</div>
<p>This means that there are enough locations on the right side of Virginia making below average income to bring this probability down, even though the red-colored areas are making almost double the average household income.</p>
<p>Let’s reverse our question now. What is the conditional probability that someone is living on the right side of the midline of Virginia given that their average household income is above the average? Let’s finally use Bayes’ Rule!</p>
<p><span class="math display">\[P(B|A) = \frac{P(A|B)P(B)}{P(A)}\]</span></p>
<div class="cell" data-tags="[]" data-execution_count="332">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>probA <span class="op">=</span> <span class="bu">sum</span>(aboveMeans[<span class="st">"sum_w"</span>]) <span class="op">/</span> <span class="bu">sum</span>(virginia[<span class="st">"sum_w"</span>])</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>probB <span class="op">=</span> <span class="bu">sum</span>(rightSideVirginia[<span class="st">"sum_w"</span>]) <span class="op">/</span> <span class="bu">sum</span>(virginia[<span class="st">"sum_w"</span>])</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>probBGivenA <span class="op">=</span> (probAGivenB <span class="op">*</span> probB) <span class="op">/</span> probA</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="sc">{}</span><span class="st">%"</span>.<span class="bu">format</span>(<span class="bu">round</span>(probBGivenA <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>84.33%</code></pre>
</div>
</div>
<p>A <em>much</em> different answer came out. This shows that you’d have a much easier time guessing where someone lives based on their income, rather than guessing someone’s income based on where they live.</p>
<p>Let’s verify our answer using regular conditional probability, just to be sure that Bayes didn’t lie to us:</p>
<p><span class="math display">\[P(B|A) = \frac{P(B \cap A)}{P(A)}\]</span></p>
<div class="cell" data-tags="[]" data-execution_count="335">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>otherProbBGivenA <span class="op">=</span> <span class="bu">sum</span>(aboveMeanRightSideVirginia[<span class="st">"sum_w"</span>]) <span class="op">/</span> <span class="bu">sum</span>(aboveMeans[<span class="st">"sum_w"</span>])</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="sc">{}</span><span class="st">%"</span>.<span class="bu">format</span>(<span class="bu">round</span>(otherProbBGivenA <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>84.33%</code></pre>
</div>
</div>
<p>Sure enough, Bayes was right!</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>